<!DOCTYPE html>
<html class="light" lang="pt-br"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Studio Step 4: Mockup Generation - Edro Creative</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;family=Playfair+Display:wght@700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#ff6600",
                        "background-light": "#ffffff",
                        "background-dark": "#1A1A1A",
                        "sidebar-light": "#F9F9F9",
                        "charcoal": "#1A1A1A",
                        "edro-gray": "#E5E5E5"
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"],
                        "serif": ["Playfair Display", "serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style type="text/tailwindcss">
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            font-size: 20px;
        }
        .active-nav-border {
            border-left: 3px solid #ff6600;
        }
        .card-shadow {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
        }
        .viewer-bg {
            background-color: #121212;
        }
    </style>
<style>
  body.edro-studio-embed aside { display: none !important; }
  body.edro-studio-embed .ml-64 { margin-left: 0 !important; }
  body.edro-studio-embed .left-64 { left: 0 !important; }
  body.edro-studio-embed main > header { display: none !important; }
</style>
</head>
<body class="bg-background-light font-display text-charcoal edro-studio-embed">
<div class="flex min-h-screen">
<aside class="w-64 bg-sidebar-light border-r border-edro-gray flex flex-col justify-between fixed h-full z-20">
<div class="flex flex-col">
<div class="p-6 flex items-center gap-3">
<div class="bg-primary size-8 rounded flex items-center justify-center text-white">
<span class="material-symbols-outlined">grid_view</span>
</div>
<div>
<h1 class="text-charcoal text-sm font-bold tracking-tight">Edro Creative</h1>
<p class="text-xs text-zinc-500">Creative Studio</p>
</div>
</div>
<nav class="mt-4 flex flex-col gap-1 px-3">
<div class="px-3 py-2 text-[10px] font-bold text-zinc-400 uppercase tracking-widest mb-1">Passos do Projeto</div>
<a class="flex items-center gap-3 px-3 py-2 text-zinc-500 rounded transition-colors" href="#">
<span class="material-symbols-outlined">check_circle</span>
<span class="text-sm font-medium">1. Identidade</span>
</a>
<a class="flex items-center gap-3 px-3 py-2 text-zinc-500 rounded transition-colors" href="#">
<span class="material-symbols-outlined">check_circle</span>
<span class="text-sm font-medium">2. Assets</span>
</a>
<a class="flex items-center gap-3 px-3 py-2 text-zinc-500 rounded transition-colors" href="#">
<span class="material-symbols-outlined">check_circle</span>
<span class="text-sm font-medium">3. Configura√ß√£o</span>
</a>
<a class="flex items-center gap-3 px-3 py-2 bg-white active-nav-border rounded-r text-charcoal shadow-sm transition-colors" href="#">
<span class="material-symbols-outlined text-primary">auto_awesome</span>
<span class="text-sm font-bold">4. Mockups</span>
</a>
</nav>
</div>
<div class="p-6">
<div class="bg-zinc-200 h-1 w-full rounded-full overflow-hidden">
<div class="bg-primary h-full w-3/4"></div>
</div>
<p class="text-[10px] mt-2 text-zinc-500 font-bold uppercase">Progresso: 75%</p>
</div>
</aside>
<main class="flex-1 ml-64 flex flex-col min-h-screen">
<header class="sticky top-0 z-10 bg-white border-b border-edro-gray h-16 px-8 flex items-center justify-between">
<div class="flex items-center gap-4">
<div class="flex items-center gap-2 text-zinc-400 text-xs font-medium uppercase tracking-wider">
<span>Creative Studio</span>
<span class="material-symbols-outlined text-sm">chevron_right</span>
<span class="text-charcoal">Gera√ß√£o de Mockups</span>
</div>
</div>
<div class="flex items-center gap-4">
<div id="edro-mockup-count" class="px-3 py-1 bg-zinc-100 rounded text-xs font-bold text-zinc-600">
                    0 de 0 mockups gerados
                </div>
<div class="h-8 w-px bg-zinc-200"></div>
<div class="flex items-center gap-3">
<button class="p-2 text-zinc-400 hover:text-charcoal">
<span class="material-symbols-outlined">help_outline</span>
</button>
<div class="size-8 rounded-full bg-cover bg-center border border-zinc-200" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBSmos1qoiD37lgy_5t_RfPwpG5lcEjK_REWk-wOmvelcPz05rGifsgqsaUo08Bx2YRqcnHGwED_yZeazvWllEHHk0IWKvTe737fXoOZRzdajeYwQNjU9Jo3M8ZkgIF6rAyJlHMdZ2-kzsf-gaVk_Ie5suZHXWxcZjgjRSIoFHzMavfCpjFE8wWjycDb7l2vxUGBfi9eB2yxrNweIotPiozrDnlDz7kYQ29aZIuPXTKe4tL4tF0S8X59vpQ7-5gJt53QxplHhC9lzQ')"></div>
</div>
</div>
</header>
<div class="flex-1 p-8 flex flex-col">
<div class="mb-8 flex justify-between items-start">
<div>
<h2 class="font-serif text-4xl text-charcoal leading-tight mb-2">Gera√ß√£o de Mockups</h2>
<p class="text-zinc-500 text-base">Visualize sua marca aplicada em cen√°rios reais de alta fidelidade.</p>
</div>
</div>
<div class="flex-1 bg-zinc-50 border border-edro-gray rounded-lg overflow-hidden flex flex-col card-shadow">
<div class="flex-1 viewer-bg relative flex items-center justify-center p-8 overflow-hidden group">
<div class="absolute top-6 left-1/2 -translate-x-1/2 bg-charcoal/80 backdrop-blur-md border border-white/10 rounded-full px-4 py-2 flex items-center gap-4 z-10">
<div class="flex items-center gap-1 border-r border-white/10 pr-4">
<button class="p-1.5 text-white hover:text-primary transition-colors">
<span class="material-symbols-outlined">zoom_in</span>
</button>
<button class="p-1.5 text-white hover:text-primary transition-colors">
<span class="material-symbols-outlined">zoom_out</span>
</button>
<button class="p-1.5 text-white hover:text-primary transition-colors">
<span class="material-symbols-outlined">restart_alt</span>
</button>
</div>
<div class="flex items-center gap-4">
<button class="flex items-center gap-2 text-xs font-bold text-white hover:text-primary transition-colors">
<span class="material-symbols-outlined">edit_note</span>
                                ANOTA√á√ïES
                            </button>
<button class="flex items-center gap-2 text-xs font-bold text-white hover:text-primary transition-colors">
<span class="material-symbols-outlined">grid_view</span>
                                GRADE
                            </button>
</div>
</div>
<div id="edro-mockup-grid" class="w-full h-full grid grid-cols-3 gap-6 overflow-y-auto custom-scrollbar p-12"></div>
</div>
<div class="h-20 bg-white border-t border-edro-gray px-6 flex items-center justify-between">
<div class="flex items-center gap-6">
<div class="flex -space-x-2">
<div class="size-8 rounded-full border-2 border-white bg-zinc-200 overflow-hidden" data-alt="Asset 1 small preview">
<div class="w-full h-full bg-primary/20 flex items-center justify-center text-[10px] font-bold text-primary">ID</div>
</div>
<div class="size-8 rounded-full border-2 border-white bg-zinc-200 overflow-hidden" data-alt="Asset 2 small preview">
<div class="w-full h-full bg-blue-500/20 flex items-center justify-center text-[10px] font-bold text-blue-500">TY</div>
</div>
<div class="size-8 rounded-full border-2 border-white bg-zinc-200 overflow-hidden" data-alt="Asset 3 small preview">
<div class="w-full h-full bg-green-500/20 flex items-center justify-center text-[10px] font-bold text-green-500">AS</div>
</div>
</div>
<div class="text-xs">
<p class="font-bold text-charcoal uppercase tracking-wider">Ativos Aplicados</p>
<p id="edro-assets-summary" class="text-zinc-500">Logo Edro + Brand Palette v2</p>
</div>
</div>
<button data-action="generate-mockups" class="flex items-center gap-2 px-6 py-3 bg-primary text-white text-sm font-bold rounded-full hover:bg-orange-600 shadow-lg shadow-orange-500/20 transition-all">
<span>üé® Gerar todos os mockups</span>
</button>
</div>
</div>
<div class="mt-8 flex justify-between items-center">
<button data-route="/studio/editor" class="flex items-center gap-2 px-5 py-2.5 text-zinc-400 hover:text-charcoal font-bold text-sm transition-all">
<span class="material-symbols-outlined">arrow_back</span>
                    Voltar ao Passo 3
                </button>
<div class="flex items-center gap-4">
<button class="px-5 py-2.5 border border-charcoal text-charcoal text-sm font-bold rounded hover:bg-zinc-50 transition-all">
                        Salvar como Rascunho
                    </button>
<button data-route="/studio/export" class="px-8 py-2.5 bg-primary text-white text-sm font-bold rounded hover:bg-orange-600 transition-all flex items-center gap-2 shadow-md">
                        Continuar
                        <span class="material-symbols-outlined !text-sm">arrow_forward</span>
</button>
</div>
</div>
</div>
</main>
</div>

<script src="/ux/edro-studio-api.js"></script>
<script>
  (function () {
    const safeParse = (value, fallback) => {
      try {
        const parsed = JSON.parse(value || '');
        return parsed ?? fallback;
      } catch {
        return fallback;
      }
    };

    const toLabel = (platform, format, displayMap) => {
      const platformLabel = displayMap?.[platform] || String(platform || '').replace(/([a-z])([A-Z])/g, '$1 $2');
      return `${platformLabel} ‚Ä¢ ${format || 'Formato'}`;
    };

    const grid = document.getElementById('edro-mockup-grid');
    const countEl = document.getElementById('edro-mockup-count');
    const assetsEl = document.getElementById('edro-assets-summary');
    const generateButtons = document.querySelectorAll('[data-action="generate-mockups"]');

    const inventory = safeParse(localStorage.getItem('edro_selected_inventory'), []);
    const displayMap = safeParse(localStorage.getItem('edro_platform_display_map'), {});
    const mockupStoreKey = 'edro_mockups';

    let mockups = safeParse(localStorage.getItem(mockupStoreKey), []);
    if (!Array.isArray(mockups) || !mockups.length) {
      mockups = inventory.map((item, index) => ({
        id: item.id || `${item.platform}-${item.format}-${index}`,
        platform: item.platform,
        format: item.format,
        generated: false,
        createdAt: new Date().toISOString(),
      }));
      localStorage.setItem(mockupStoreKey, JSON.stringify(mockups));
    }

    const updateStage = async (stage, status) => {
      const briefingId = localStorage.getItem('edro_briefing_id');
      if (!briefingId || !window.EdroStudio?.request) return;
      try {
        await window.EdroStudio.request(`/edro/briefings/${briefingId}/stages/${stage}`, {
          method: 'PATCH',
          body: JSON.stringify({ status }),
        });
      } catch {
        // ignore workflow conflicts
      }
    };

    const render = () => {
      if (!grid) return;
      const total = mockups.length;
      const generated = mockups.filter((item) => item.generated).length;
      if (countEl) {
        countEl.textContent = `${generated} de ${total} mockups gerados`;
      }

      if (assetsEl) {
        const platforms = new Set(mockups.map((item) => item.platform).filter(Boolean));
        assetsEl.textContent = `${platforms.size} plataformas ‚Ä¢ ${total} formatos selecionados`;
      }

      if (!total) {
        grid.innerHTML = '<div class="col-span-3 text-sm text-zinc-400">Nenhum formato selecionado ainda.</div>';
        return;
      }

      grid.innerHTML = mockups
        .map((item) => {
          const label = toLabel(item.platform, item.format, displayMap);
          const statusClass = item.generated ? 'bg-green-100 text-green-700' : 'bg-zinc-100 text-zinc-500';
          const statusText = item.generated ? 'Gerado' : 'Rascunho';
          return `
            <div class="aspect-square bg-zinc-900 border border-white/5 rounded-lg overflow-hidden relative group/item">
              <div class="absolute inset-0 bg-gradient-to-br from-zinc-900 via-zinc-800 to-zinc-700 opacity-90"></div>
              <div class="absolute top-3 right-3">
                <span class="${statusClass} text-[10px] font-bold px-2 py-1 rounded uppercase">${statusText}</span>
              </div>
              <div class="absolute inset-0 flex flex-col items-center justify-center text-center px-6">
                <p class="text-white text-xs font-bold uppercase tracking-wider">${label}</p>
                <p class="text-zinc-300 text-[10px] mt-2">Mockup pronto para aprova√ß√£o</p>
              </div>
            </div>
          `;
        })
        .join('') +
        `
          <div class="aspect-square bg-zinc-800/50 border-2 border-dashed border-white/10 rounded-lg flex flex-col items-center justify-center p-6 text-center hover:bg-zinc-800/80 transition-all cursor-pointer group/gen" data-action="generate-mockups">
            <div class="size-16 bg-primary rounded-full flex items-center justify-center text-white mb-4 group-hover/gen:scale-110 transition-transform">
              <span class="material-symbols-outlined !text-3xl">auto_awesome</span>
            </div>
            <h4 class="text-white font-bold mb-1">Gerar novos mockups</h4>
            <p class="text-zinc-500 text-xs px-4 text-balance">Expanda sua galeria com mais aplica√ß√µes autom√°ticas</p>
          </div>
        `;

      grid.querySelectorAll('[data-action="generate-mockups"]').forEach((btn) => {
        btn.addEventListener('click', handleGenerateAll);
      });
    };

    const handleGenerateAll = () => {
      mockups = mockups.map((item) => ({ ...item, generated: true }));
      localStorage.setItem(mockupStoreKey, JSON.stringify(mockups));
      render();
    };

    generateButtons.forEach((button) => {
      button.addEventListener('click', handleGenerateAll);
    });

    updateStage('producao', 'in_progress');
    const continueButton = document.querySelector('[data-route="/studio/export"]');
    if (continueButton) {
      continueButton.addEventListener('click', () => updateStage('producao', 'done'));
    }

    render();
  })();
</script>
<script src="/ux/edro-links.js"></script>
</body></html>


